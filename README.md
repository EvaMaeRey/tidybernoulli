
<!-- README.md is generated from README.Rmd. Please edit that file -->

# tidybernoulli

<!-- badges: start -->

<!-- badges: end -->

The goal of tidybernoulli creates a framework work with independent,
repeated trials in an intuitive, fluid, and computation-friendly way.

A Bernoulli trial is an independent trial with two outcomes (usually
success and a failure), where probabilities associated with each new
trial are independent of previous trials.

Instead of looking at the realization of single trials and trials
histories, we look at probability distributions that are generated by
adding Bernoulli trials. Data frames that are generated contain a row
for each outcome history and two columns for each trial index – one
column with the trial outcome and one column with the associated
probability.

Once all the outcome-probability pathways have been built up, summary
functions allow us to ask questions about global outcomes; e.g. how
likely are we to observe at least one success in 5 fair coin flips.
Students will be able to see distributions like the binomial
distribution emerge from first principles.

## Installation

You can install the development version of tidybernoulli from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("EvaMaeRey/tidybernoulli")
```

Then load the package.

``` r
library(tidybernoulli)
```

# Single trials

We provide some single Bernoulli trial functions

``` r
bernoulli_trial()
#>   outcome prob
#> 1       0 0.75
#> 2       1 0.25
weighted_coin()
#>   outcome prob
#> 1   tails 0.25
#> 2   heads 0.75
fair_coin()
#>   outcome prob
#> 1   tails  0.5
#> 2   heads  0.5
```

As well as few non-bernoulli events and probabilities

``` r
prize_wheel()
#>   outcome           prob
#> 1      $0 9 of 12 slices
#> 2      $1 2 of 12 slices
#> 3      $3  1 of 12 slice
```

# Multiple trials

This is a basic example which shows you how to solve a common problem:

``` r
## basic example code
```

``` r
bernoulli_trial()
#>   outcome prob
#> 1       0 0.75
#> 2       1 0.25

trial_init() |>
  trial_advance()
#> # A tibble: 4 × 4
#>   t1_outcome t1_prob t2_outcome t2_prob
#>        <int>   <dbl>      <int>   <dbl>
#> 1          0    0.75          0    0.75
#> 2          0    0.75          1    0.25
#> 3          1    0.25          0    0.75
#> 4          1    0.25          1    0.25


trial_init() |>
  trial_advance() |>
  trial_advance() 
#> # A tibble: 8 × 6
#>   t1_outcome t1_prob t2_outcome t2_prob t3_outcome t3_prob
#>        <int>   <dbl>      <int>   <dbl>      <int>   <dbl>
#> 1          0    0.75          0    0.75          0    0.75
#> 2          0    0.75          0    0.75          1    0.25
#> 3          0    0.75          1    0.25          0    0.75
#> 4          0    0.75          1    0.25          1    0.25
#> 5          1    0.25          0    0.75          0    0.75
#> 6          1    0.25          0    0.75          1    0.25
#> 7          1    0.25          1    0.25          0    0.75
#> 8          1    0.25          1    0.25          1    0.25
```

# Summarizing possible outcome histories

``` r
library(magrittr)
trial_init(prob = .3) %>%
  trial_advance() %>%
  trial_advance() %>%
  .$out %>%
  sum_across() %>%
  prod_across()
#> # A tibble: 8 × 8
#>   global_probs global_outcome t1_outcome t1_prob t2_ou…¹ t2_prob t3_ou…² t3_prob
#>          <dbl>          <dbl>      <int>   <dbl>   <int>   <dbl>   <int>   <dbl>
#> 1        0.343              0          0     0.7       0     0.7       0     0.7
#> 2        0.147              1          0     0.7       0     0.7       1     0.3
#> 3        0.147              1          0     0.7       1     0.3       0     0.7
#> 4        0.063              2          0     0.7       1     0.3       1     0.3
#> 5        0.147              1          1     0.3       0     0.7       0     0.7
#> 6        0.063              2          1     0.3       0     0.7       1     0.3
#> 7        0.063              2          1     0.3       1     0.3       0     0.7
#> 8        0.027              3          1     0.3       1     0.3       1     0.3
#> # … with abbreviated variable names ¹​t2_outcome, ²​t3_outcome
```

``` r
library(magrittr)
bernoulli_trial(prob = .5) %>%
  add_trials() %>%
  add_trials() %>%
  add_trials(5) %>%
  .$out %>%
  sum_across() %>%
  prod_across()
#> # A tibble: 128 × 16
#>    global_probs global…¹ t1_ou…² t1_prob t2_ou…³ t2_prob t3_ou…⁴ t3_prob t4_ou…⁵
#>           <dbl>    <dbl>   <int>   <dbl>   <int>   <dbl>   <int>   <dbl>   <int>
#>  1      0.00781        0       0     0.5       0     0.5       0     0.5       0
#>  2      0.00781        1       0     0.5       0     0.5       0     0.5       0
#>  3      0.00781        1       0     0.5       0     0.5       0     0.5       0
#>  4      0.00781        2       0     0.5       0     0.5       0     0.5       0
#>  5      0.00781        1       0     0.5       0     0.5       0     0.5       0
#>  6      0.00781        2       0     0.5       0     0.5       0     0.5       0
#>  7      0.00781        2       0     0.5       0     0.5       0     0.5       0
#>  8      0.00781        3       0     0.5       0     0.5       0     0.5       0
#>  9      0.00781        1       0     0.5       0     0.5       0     0.5       1
#> 10      0.00781        2       0     0.5       0     0.5       0     0.5       1
#> # … with 118 more rows, 7 more variables: t4_prob <dbl>, t5_outcome <int>,
#> #   t5_prob <dbl>, t6_outcome <int>, t6_prob <dbl>, t7_outcome <int>,
#> #   t7_prob <dbl>, and abbreviated variable names ¹​global_outcome, ²​t1_outcome,
#> #   ³​t2_outcome, ⁴​t3_outcome, ⁵​t4_outcome
```

# Further summary based on outcome of interest…

``` r
library(dplyr)
#> 
#> Attaching package: 'dplyr'
#> The following objects are masked from 'package:stats':
#> 
#>     filter, lag
#> The following objects are masked from 'package:base':
#> 
#>     intersect, setdiff, setequal, union
bernoulli_trial(prob = .5) %>%
  add_trials() %>%
  add_trials() %>%
  add_trials(5) %>%
  .$out %>%
  sum_across() %>%
  prod_across() %>%
  group_by(global_outcome) %>%
  summarize(probs = sum(global_probs))
#> # A tibble: 8 × 2
#>   global_outcome   probs
#>            <dbl>   <dbl>
#> 1              0 0.00781
#> 2              1 0.0547 
#> 3              2 0.164  
#> 4              3 0.273  
#> 5              4 0.273  
#> 6              5 0.164  
#> 7              6 0.0547 
#> 8              7 0.00781
```

# Cross-validate work

``` r
dbinom(x =  0:7, size = 7, prob = .5)
#> [1] 0.0078125 0.0546875 0.1640625 0.2734375 0.2734375 0.1640625 0.0546875
#> [8] 0.0078125
```

# Peek into internals of tidybernoulli

``` r
readLines("R/bernoulli-trial.R")[150:180]
#>  [1] "#"                                                                                  
#>  [2] "# my_trials"                                                                        
#>  [3] "#"                                                                                  
#>  [4] "# my_trials$init(trial = bernoulli_trial())"                                        
#>  [5] "# my_trials$out"                                                                    
#>  [6] "# my_trials$update()"                                                               
#>  [7] "# my_trials$out"                                                                    
#>  [8] ""                                                                                   
#>  [9] "Trials <- R6::R6Class(\"Trials\","                                                  
#> [10] "                  public = list("                                                   
#> [11] ""                                                                                   
#> [12] "                    # objects"                                                      
#> [13] "                    trial = NULL,"                                                  
#> [14] "                    index = NULL,"                                                  
#> [15] "                    out = NULL,"                                                    
#> [16] ""                                                                                   
#> [17] ""                                                                                   
#> [18] "                    # functions"                                                    
#> [19] "                    init = function(trial = NULL){"                                 
#> [20] ""                                                                                   
#> [21] "                      self$trial <- trial"                                          
#> [22] "                      self$index <- 1"                                              
#> [23] ""                                                                                   
#> [24] "                      self$out <- cross_trials(self$trial, num_trials = self$index)"
#> [25] ""                                                                                   
#> [26] "                      invisible(self)          #returns"                            
#> [27] ""                                                                                   
#> [28] ""                                                                                   
#> [29] "                    },"                                                             
#> [30] ""                                                                                   
#> [31] "                    update = function(increment = 1){ # a method"
```
